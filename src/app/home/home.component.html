<mat-sidenav-container class="home-container">
  <!-- Sidebar -->
  <mat-sidenav #sidenav [(opened)]="isSidebarOpen" [mode]="sidebarMode">
    <app-sidebar [remotes]="remotes" (remoteSelected)="selectRemote($event)">
    </app-sidebar>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content class="main-content" position="start">

    <!-- Sidebar Toggle Button -->
    <div class="sidebar-button">
      <button class="toggle-sidebar" (click)="sidenav.toggle()">
        <mat-icon svgIcon="menu-bar"></mat-icon>
      </button>
    </div>

    <!-- Ellipsis Vertical Button -->
    <div class="ellipsis-button-container" *ngIf="selectedRemote">
      <button matButton class="ellipsis-button" [matMenuTriggerFor]="remoteOptionsMenu">
        <mat-icon svgIcon="ellipsis-vertical"></mat-icon>
      </button>
      <mat-menu #remoteOptionsMenu="matMenu">
        <!-- ✅ Show in Tray Menu (Toggle) -->
        <button mat-menu-item (click)="$event.stopPropagation()">
          <mat-slide-toggle [checked]="getRemoteSettingValue(selectedRemote.remoteSpecs.name, 'show_in_tray_menu')"
            (change)="saveRemoteSettings(selectedRemote.remoteSpecs.name, {
              show_in_tray_menu: $event.checked
            })">
            <p style="font-size: 16px; font-weight: 600;">Show in Tray Menu</p>
          </mat-slide-toggle>
        </button>

        <mat-divider></mat-divider>

        <!-- ✅ Remote Actions -->
        <button mat-menu-item>
          <span>View Logs</span>
        </button>
        <button mat-menu-item>
          <span>Export Configuration</span>
        </button>
        <button mat-menu-item (click)="resetRemoteSettings()">
          <span>Reset Settings</span>
        </button>

        <mat-divider></mat-divider>

        <!-- ❌ Delete Remote (Destructive Action) -->
        <button mat-menu-item class="delete-option" (click)="deleteRemote(selectedRemote.remoteSpecs.name)">
          <span>Delete Remote</span>
        </button>
      </mat-menu>

    </div>


    <!-- Add Remote Dialog -->
    <div class="add-remote" *ngIf="remotes.length === 0">
      <mat-icon svgIcon="rclone-2"
        style="width: 100%; min-height: 100px; height: 200px; margin-bottom: 20px;"></mat-icon>
      <h2>RClone Manager</h2>
      <p>Easily manage your RClone remotes. If you're new to RClone, use "Add Quick Remote" for a fast and simple setup.
      </p>
      <button (click)="openQuickAddRemoteModal()" class="secondary">
        <mat-icon svgIcon="add"></mat-icon>
        Add Quick Remote
      </button>
      <button (click)="openRemoteConfigModal()" class="secondary">
        <mat-icon svgIcon="add"></mat-icon> Add Detailed Remote
      </button>
    </div>

    <app-mount-overview *ngIf="currentTab === 'mount' && remotes.length > 0 && !selectedRemote" [remotes]="remotes"
      [selectedRemote]="selectedRemote" (remoteSelected)="selectRemote($event)" (mountRemote)="mountRemote($event)"
      (openInFiles)="openRemoteInFiles($event)" style="width: 100%;">
    </app-mount-overview>

    <!-- Sync Overview -->
    <app-sync-overview *ngIf="currentTab === 'sync' && remotes.length > 0 && !selectedRemote" style="width: 100%;">
    </app-sync-overview>

    <!-- Copy Overview -->
    <app-copy-overview *ngIf="currentTab === 'copy' && remotes.length > 0 && !selectedRemote" style="width: 100%;">
    </app-copy-overview>

    <!-- Jobs Overview -->
    <app-jobs-overview *ngIf="currentTab === 'jobs' && remotes.length > 0 && !selectedRemote" style="width: 100%;">
    </app-jobs-overview>


    <!-- Remote Details (Show When a Remote is Selected) -->
    <app-mount-detail *ngIf="selectedRemote && currentTab === 'mount'" [selectedRemote]="selectedRemote"
      [remoteSettings]="loadRemoteSettings(selectedRemote.remoteSpecs.name)" (openInFiles)="openRemoteInFiles($event)"
      (mountRemote)="mountRemote($event)" (unmountRemote)="unmountRemote($event)"
      (openRemoteConfigModal)="openRemoteConfigModal($event.editTarget, $event.existingConfig)" style="width: 100%;">
    </app-mount-detail>

    <app-sync-detail *ngIf="selectedRemote && currentTab === 'sync'" [selectedRemote]="selectedRemote"
      style="width: 100%;">
    </app-sync-detail>

    <app-copy-detail *ngIf="selectedRemote && currentTab === 'copy'" [selectedRemote]="selectedRemote"
      style="width: 100%;">
    </app-copy-detail>

    <app-job-detail *ngIf="selectedRemote && currentTab === 'jobs'" [selectedRemote]="selectedRemote"
      style="width: 100%;">
    </app-job-detail>

  </mat-sidenav-content>
</mat-sidenav-container>